import{r as a,j as e,aH as C,aJ as H,b7 as R,aw as V,bB as h,bA as q,bC as P,bw as U,bo as Y}from"./vendor-LI3anQjP.js";import{L as G,B as o}from"./badge-0Mmftv1n.js";import{C as k,a as T,b as L,d as M,e as E}from"./charts_panel-DZ6GAu93.js";import{a as J,B as d,L as u,I as K}from"./main-Dx6KqeX5.js";import{T as O}from"./textarea-BkG9H_Pj.js";import{S as Q,a as W,b as X,c as Z,d as m}from"./select-6GBzacIP.js";import{l as $,c as ee,s as se,d as te}from"./broadcast-BhQ2ULP-.js";import{B as ae}from"./BrandedEmptyState-3fXBKWGy.js";import"./vendor-recharts-iVWv7ny2.js";const he=()=>{const{toast:r}=J(),[c,g]=a.useState(""),[i,p]=a.useState(""),[b,j]=a.useState("general"),[l,f]=a.useState(!1),[y,v]=a.useState([]),[N,w]=a.useState(!1),[S,x]=a.useState(1),[F,_]=a.useState(!0),n=a.useCallback(async s=>{try{w(!0);const t=await $(s);v(s===1?t.results:I=>[...I,...t.results]),_(!!t.next)}catch(t){r({title:"Error",description:t.message||"Failed to load broadcasts",className:"bg-destructive text-destructive-foreground"})}finally{w(!1)}},[r]);a.useEffect(()=>{n(S).catch(()=>{})},[S,n]);const B=async()=>{if(!c.trim()||!i.trim()){r({title:"Required Fields",description:"Please enter both title and message content.",className:"bg-warning text-warning-foreground"});return}f(!0);try{const s=await ee({title:c.trim(),content:i.trim(),message_type:b}),t=await se(s.id);t.success?(r({title:"Broadcast Sent",description:"Your message has been sent to all customers successfully.",className:"bg-success text-success-foreground"}),g(""),p(""),j("general"),x(1),await n(1)):r({title:"Send Failed",description:t.error||"Failed to send broadcast to customers",className:"bg-destructive text-destructive-foreground"})}catch(s){r({title:"Error",description:s.message||"Failed to create or send broadcast",className:"bg-destructive text-destructive-foreground"})}finally{f(!1)}},D=async s=>{try{await te(s),r({title:"Deleted",description:"Broadcast message deleted successfully",className:"bg-success text-success-foreground"}),x(1),await n(1)}catch(t){r({title:"Error",description:t.message||"Failed to delete broadcast",className:"bg-destructive text-destructive-foreground"})}},A=s=>new Date(s).toLocaleString(),z=s=>s?e.jsx(o,{className:"bg-success/20 text-success",children:"Sent"}):e.jsx(o,{className:"bg-warning/20 text-warning",children:"Pending"});return e.jsx(G,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-slate-950 via-slate-900 to-primary/20 px-8 py-10 text-white shadow-xl shadow-primary/20",children:e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(o,{variant:"outline",className:"w-fit border-white/20 bg-white/10 uppercase tracking-[0.3em] text-xs text-primary/80",children:"Customer Broadcasts"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold md:text-4xl",children:"Vendora Broadcast Studio"}),e.jsx("p",{className:"mt-3 max-w-2xl text-sm text-slate-200 md:text-base",children:"Ship real-time alerts, price updates, and availability news to every buyer in one polished, vendor-branded feed."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(d,{asChild:!0,size:"sm",variant:"secondary",className:"bg-white/10 text-white hover:bg-white/20",children:e.jsxs(C,{to:"/settings",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Back to Settings"]})}),e.jsx(d,{asChild:!0,size:"sm",variant:"outline",className:"border-white/30 bg-transparent text-white hover:bg-white/10",children:e.jsxs(C,{to:"/availability",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Update Availability"]})})]})]}),e.jsxs("div",{className:"relative flex flex-col items-start gap-3 rounded-2xl border border-white/10 bg-white/5 px-5 py-4 text-sm text-slate-100 md:max-w-xs",children:[e.jsx(V,{className:"h-5 w-5 text-primary"}),e.jsx("p",{className:"text-base font-semibold text-white",children:"Stay top-of-mind"}),e.jsx("p",{className:"text-xs text-slate-200/80",children:"Every broadcast drops straight into your Telegram bot so buyers see your latest promo, rates, or downtime instantly."})]})]})}),e.jsxs(k,{className:"bg-gradient-card border-border",children:[e.jsxs(T,{children:[e.jsxs(L,{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:"Send Broadcast Message"})]}),e.jsx(M,{children:"Deliver polished announcements the moment buyers open your Vendora Telegram bot. Draft, tag, and send in one motion."})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"title",children:"Title"}),e.jsx(K,{id:"title",placeholder:"Enter message title...",value:c,onChange:s=>g(s.target.value),className:"bg-background border-border",maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"type",children:"Message Type"}),e.jsxs(Q,{value:b,onValueChange:s=>j(s),children:[e.jsx(W,{className:"bg-background border-border",children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(m,{value:"general",children:"General"}),e.jsx(m,{value:"asset_added",children:"Asset Added"}),e.jsx(m,{value:"rate_updated",children:"Rate Updated"}),e.jsx(m,{value:"order_status",children:"Order Status"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"content",children:"Message Content"}),e.jsx(O,{id:"content",placeholder:"Type your broadcast message here...",value:i,onChange:s=>p(s.target.value),rows:4,className:"bg-background border-border resize-none",maxLength:500}),e.jsxs("p",{className:"text-sm text-muted-foreground text-right",children:[i.length,"/500 characters"]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:B,disabled:l||!c.trim()||!i.trim(),className:"bg-gradient-primary hover:opacity-90",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),l?"Sending...":"Send Broadcast"]})})]})]}),e.jsxs(k,{className:"bg-gradient-card border-border",children:[e.jsxs(T,{children:[e.jsxs(L,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-5 w-5"}),e.jsx("span",{children:"Broadcast History"})]}),e.jsx(M,{children:"Track campaign reach, resend favourites, and repeat messages that work best."})]}),e.jsx(E,{children:y.length>0?e.jsxs("div",{className:"space-y-4",children:[y.map(s=>e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-secondary/20",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:A(s.created_at)}),e.jsx(o,{variant:"outline",className:"text-xs",children:s.message_type.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[z(s.is_sent),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>D(s.id),className:"text-destructive hover:text-destructive/80",children:e.jsx(U,{className:"h-3 w-3"})})]})]}),e.jsx("h4",{className:"font-medium mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:s.content})]},s.id)),F&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(d,{variant:"outline",size:"sm",className:"border-border",onClick:()=>x(s=>s+1),disabled:N,children:N?"Loading...":"Load More Messages"})})]}):e.jsx(ae,{icon:Y,badge:"Let them know",title:"Announce your next move",description:"Keep buyers excited with an availability drop, promo, or rate change. Your first broadcast primes the bot for every future update.",actions:e.jsxs(d,{onClick:B,disabled:l||!c.trim()||!i.trim(),className:"bg-gradient-primary hover:opacity-90",children:[e.jsx(h,{className:"mr-2 h-4 w-4"}),l?"Sending...":"Send your first broadcast"]}),className:"bg-slate-950"})})]})]})})};export{he as default};

import{r,j as e,aw as v,aN as l,bf as b,aW as w,aP as N}from"./vendor-LI3anQjP.js";import{L as f,B as d}from"./badge-0Mmftv1n.js";import{u as k,h as g,B as o}from"./main-Dx6KqeX5.js";import{C,a as A,b as R,d as q,e as S}from"./charts_panel-DZ6GAu93.js";import{B}from"./BrandedEmptyState-3fXBKWGy.js";import"./vendor-recharts-iVWv7ny2.js";const I=()=>{const{user:a}=k(),[c,j]=r.useState([]),[m,x]=r.useState(!1),[p,h]=r.useState(!1),i=r.useCallback(async()=>{x(!0);try{const t=(await g.get("/api/v1/accounts/payment-requests/?status=pending")).data,n=Array.isArray(t)?t:t.results||[];j(n)}catch(s){console.error(s)}finally{x(!1)}},[]);r.useEffect(()=>{!a||!(a.is_staff||a.is_superuser)||i()},[a,i]);const y=async()=>{h(!0),await i(),h(!1)},u=async(s,t)=>{try{await g.post(`/api/v1/accounts/payment-requests/${s}/${t}/`),await i()}catch(n){console.error(n),alert(n?.response?.data?.detail||"Failed")}};return!a||!(a.is_staff||a.is_superuser)?e.jsx(f,{children:e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"You need admin access to view payment requests."})}):e.jsx(f,{title:"Admin Payments",children:e.jsxs("div",{className:"space-y-8 pb-10",children:[e.jsx("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-slate-950 via-slate-900 to-primary/20 px-8 py-10 text-white shadow-xl shadow-primary/20",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{variant:"outline",className:"w-fit border-white/20 bg-white/10 uppercase tracking-[0.3em] text-xs text-primary/80",children:"Operations"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-3xl font-semibold md:text-4xl",children:"Approve vendor upgrades"}),e.jsx("p",{className:"max-w-2xl text-sm text-slate-200 md:text-base",children:"Keep accounts active by approving valid receipts quickly and rejecting suspicious ones."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[e.jsxs(d,{variant:"secondary",className:"bg-white/15 text-white hover:bg-white/20",children:["Pending queue: ",c.length]}),e.jsx(d,{variant:"outline",className:"border-white/20 bg-white/10 text-white",children:"Telegram bot escalations auto-sync here"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 text-sm text-slate-100 shadow-inner",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.3em]",children:"Daily cadence"})]}),e.jsxs("ul",{className:"mt-4 space-y-2 text-sm text-slate-200/90",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{className:"mt-1 h-3.5 w-3.5 text-primary/80"}),e.jsx("span",{children:"Check new receipts at open, after lunch, and pre-close."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{className:"mt-1 h-3.5 w-3.5 text-primary/80"}),e.jsx("span",{children:"Approve verified payments to unlock unlimited orders immediately."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{className:"mt-1 h-3.5 w-3.5 text-primary/80"}),e.jsx("span",{children:"Reject suspicious uploads so fraudsters never touch Vendora Pro."})]})]})]})]})}),e.jsxs(C,{className:"border border-border bg-gradient-card",children:[e.jsxs(A,{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-xl font-semibold",children:"Pending payment requests"}),e.jsx(q,{children:"Review receipts and unlock the right accounts. Actions update the vendor account instantly."})]}),e.jsxs(o,{onClick:y,disabled:p||m,variant:"secondary",className:"gap-2",children:[e.jsx(b,{className:`h-4 w-4 ${p?"animate-spin":""}`}),"Refresh queue"]})]}),e.jsx(S,{className:"space-y-4",children:m?e.jsx("div",{className:"py-10 text-center text-muted-foreground",children:"Loading payment requestsâ€¦"}):c.length===0?e.jsx(B,{icon:w,badge:"Queue clear",title:"No pending receipts",description:"Every vendor upgrade has been reviewed. Keep this tab handy as the Telegram bot feeds new submissions.",className:"bg-slate-950"}):e.jsx("ul",{className:"space-y-4",children:c.map(s=>{const t=typeof s.vendor=="object"?s.vendor.name||s.vendor.email:`Vendor ${s.vendor}`;return e.jsx("li",{className:"rounded-2xl border border-border/70 bg-background/90 p-5 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-base font-semibold text-foreground flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 text-primary"}),t]}),e.jsxs("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:["Request #",s.id]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Submitted ",new Date(s.created_at).toLocaleString()]}),s.note&&e.jsx("p",{className:"mt-2 text-sm text-foreground",children:s.note})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{onClick:()=>u(s.id,"approve"),className:"bg-gradient-success hover:opacity-90",children:"Approve & activate"}),e.jsx(o,{onClick:()=>u(s.id,"reject"),variant:"destructive",children:"Reject"})]})]})},s.id)})})})]})]})})};export{I as default};
